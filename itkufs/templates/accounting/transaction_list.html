{% load i18n %}
<h3>{% trans "Transactions" %}</h3>

{% if not transaction_list %}
<p>{% trans "No transactions found." %}</p>
{% else %}

{% include "accounting/transaction_list_menu.html" %}

<table class="tablelist">
	<tr>
		<th>{% trans "Status" %}</th>
		<th>{% trans "Account" %}</th>
		<th>{% trans "Debit" %}</th>
		<th>{% trans "Credit" %}</th>
		<th>{% trans "Details" %}</th>
	</tr>
	{% for t in transaction_list %}
	<tr class="{% cycle 'evenrow' 'oddrow' as trclass %}
		{% if t.is_rejected %}rejected{% else %}
		{% if not t.is_received %}pending{% endif %}{% endif %}">
		<td rowspan="{{ t.entry_set.all.count }}">
				{% blocktrans with t.get_status_display as status and t.last_modified|date:"Y-m-d H:i" as last_modified %}
				{{ status }} at {{ last_modified }}
				{% endblocktrans %}
		</td>
		{% for e in t.entry_set.all %}
		<td class="account">
			{% if is_admin %}
			<a href="{% url group-summary e.account.group.slug %}">{{e.account.group.name}}</a>:
			<a href="{% url account-summary e.account.group.slug,e.account.slug%}">{{e.account.name}}</a>
			{% else %}
				{{ e.account.group.name }}: {{e.account.name}}
			{% endif %}
		</td>
		<td class="align_right debit">
			{% if e.debit %}
			{{e.debit|stringformat:"0.2f"}}
			{% endif %}
		</td>
		<td class="align_right credit">
			{% if e.credit %}
			{{e.credit|stringformat:"0.2f"}}
			{% endif %}
		</td>
		{% if forloop.first %}
		<td rowspan="{{ t.entry_set.all.count }}" class="details">
			*FIXME* Details link
		</td>
		{% endif %}
	</tr>
	<tr class="{{ trclass }}
		{% if t.is_rejected %}rejected{% else %}
		{% if not t.is_received %}pending{% endif %}{% endif %}">
		{% endfor %}
	</tr>
	{% endfor %}
</table>

{% include "accounting/transaction_list_menu.html" %}

{% endif %}
